# This is the docker-compose file for in cloud (edge) development and production

version: "1.0.0"

services:
  prepit-edge-prod-server:
    container_name: prepit-edge-prod-server
    secrets:
      - prepit-secret
    image: ghcr.io/jerryyang666/prepit-edge:prod
    volumes:
      - ./edge_prod_volume:/app/volume_cache:rw
    networks:
      - prodnet
    depends_on:
      - nginx-server
  redis-prod-server:
    container_name: redis-prod-server
    image: redis/redis-stack-server:latest
    volumes:
      - ./redis_prod_volume:/data:rw
    networks:
      - prodnet
  nginx-server:
    container_name: nginx-server
    image: nginx:latest
    ports:
      - 80:80
      - 443:443
    volumes:
      - ./files/nginx_conf:/etc/nginx/conf.d:ro
      - ./files/ssl:/etc/nginx/ssl:ro
    networks:
      - prodnet

networks:
  prodnet:

secrets:
  prepit-secret:
    file: edcwsxqaz